<app-admin-layout title="üìä Dashboard Admin" subtitle="Gestion de la brocante">
  <!-- Main Content -->
  <main class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 lg:py-8" *ngIf="!isLoading; else loadingTemplate">
    
    <!-- Cartes statistiques - RESPONSIVE -->
    <div class="grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 lg:mb-8">
      
      <!-- Total Produits -->
      <div class="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-4 sm:p-5 lg:p-6 border border-amber-200">
        <div class="flex items-center">
          <div class="p-2 sm:p-3 bg-amber-100 rounded-lg mr-3 sm:mr-4 flex-shrink-0">
            <span class="text-lg sm:text-xl lg:text-2xl">üì¶</span>
          </div>
          <div class="min-w-0 flex-1">
            <p class="text-amber-600 text-xs sm:text-sm font-medium truncate">Total Produits</p>
            <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-amber-800 mt-1">
              {{ stats.totalProducts }}
            </p>
          </div>
        </div>
      </div>

      <!-- Stock Total -->
      <div class="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-4 sm:p-5 lg:p-6 border border-amber-200">
        <div class="flex items-center">
          <div class="p-2 sm:p-3 bg-green-100 rounded-lg mr-3 sm:mr-4 flex-shrink-0">
            <span class="text-lg sm:text-xl lg:text-2xl">üè™</span>
          </div>
          <div class="min-w-0 flex-1">
            <p class="text-green-600 text-xs sm:text-sm font-medium truncate">Stock Total</p>
            <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-green-800 mt-1">
              {{ stats.totalStock }}
            </p>
          </div>
        </div>
      </div>

      <!-- Valeur Stock -->
      <div class="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-4 sm:p-5 lg:p-6 border border-amber-200">
        <div class="flex items-center">
          <div class="p-2 sm:p-3 bg-blue-100 rounded-lg mr-3 sm:mr-4 flex-shrink-0">
            <span class="text-lg sm:text-xl lg:text-2xl">üí∞</span>
          </div>
          <div class="min-w-0 flex-1">
            <p class="text-blue-600 text-xs sm:text-sm font-medium truncate">Valeur Stock</p>
            <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-blue-800 mt-1">
              {{ stats.totalValue | number }} FCFA
            </p>
          </div>
        </div>
      </div>

      <!-- Cat√©gories -->
      <div class="bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow p-4 sm:p-5 lg:p-6 border border-amber-200">
        <div class="flex items-center">
          <div class="p-2 sm:p-3 bg-purple-100 rounded-lg mr-3 sm:mr-4 flex-shrink-0">
            <span class="text-lg sm:text-xl lg:text-2xl">üè∑Ô∏è</span>
          </div>
          <div class="min-w-0 flex-1">
            <p class="text-purple-600 text-xs sm:text-sm font-medium truncate">Cat√©gories</p>
            <p class="text-xl sm:text-2xl lg:text-3xl font-bold text-purple-800 mt-1">
              {{ stats.totalCategories }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Produits r√©cents - RESPONSIVE -->
    <div class="bg-white rounded-xl shadow-sm border border-amber-200 overflow-hidden">
      <!-- En-t√™te -->
      <div class="px-4 sm:px-6 py-4 bg-amber-50 border-b border-amber-200">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
          <h2 class="text-lg sm:text-xl font-bold text-amber-800 flex items-center gap-2">
            <span class="text-xl">üÜï</span>
            Produits R√©cemment Ajout√©s
          </h2>
          <button
            routerLink="/admin/products"
            class="w-full sm:w-auto bg-amber-500 hover:bg-amber-600 text-white px-4 py-2.5 rounded-lg transition-colors text-sm font-medium"
          >
            Voir tous les produits
          </button>
        </div>
      </div>

      <!-- Liste des produits -->
      <div class="p-4 sm:p-6">
        <div *ngIf="recentProducts.length > 0; else noProductsTemplate" class="space-y-3 sm:space-y-4">
          
          <!-- Produit - Version mobile compacte -->
          <div *ngFor="let product of recentProducts"
               class="flex flex-col sm:flex-row sm:items-center justify-between p-3 sm:p-4 border border-amber-100 rounded-lg hover:bg-amber-50 transition-colors gap-3">
            
            <!-- Contenu principal -->
            <div class="flex items-center gap-3 sm:gap-4 flex-1 min-w-0">
              <img
                [src]="product.image"
                [alt]="product.name"
                class="w-10 h-10 sm:w-12 sm:h-12 object-cover rounded-lg flex-shrink-0"
              />
              <div class="min-w-0 flex-1">
                <h3 class="font-semibold text-amber-900 text-sm sm:text-base truncate">
                  {{ product.name }}
                </h3>
                <p class="text-amber-600 text-xs sm:text-sm mt-1">
                  {{ product.price | number }} FCFA ‚Ä¢ Stock: {{ product.quantity }}
                </p>
              </div>
            </div>

            <!-- Cat√©gorie - Position diff√©rente sur mobile -->
            <div class="flex justify-between sm:justify-end items-center gap-2">
              <span class="px-2 py-1 bg-amber-100 text-amber-800 rounded-full text-xs font-medium">
                {{ product.category }}
              </span>
              <!-- Bouton action mobile optionnel -->
              <button class="sm:hidden text-amber-500 hover:text-amber-700">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </button>
            </div>
          </div>

        </div>

        <ng-template #noProductsTemplate>
          <div class="text-center py-8 sm:py-12">
            <div class="text-4xl sm:text-5xl mb-4">üì¶</div>
            <h3 class="text-lg sm:text-xl font-semibold text-amber-800 mb-2">
              Aucun produit pour le moment
            </h3>
            <p class="text-amber-600 text-sm sm:text-base mb-6">
              Commencez par ajouter votre premier produit √† la brocante.
            </p>
            <button
              routerLink="/admin/products"
              class="bg-amber-500 hover:bg-amber-600 text-white px-6 py-3 rounded-lg transition-colors font-medium"
            >
              + Ajouter votre premier produit
            </button>
          </div>
        </ng-template>
      </div>
    </div>
  </main>

  <!-- Loading Template Responsive -->
  <ng-template #loadingTemplate>
    <div class="min-h-[50vh] sm:min-h-[400px] flex items-center justify-center">
      <div class="text-center">
        <div class="inline-block animate-spin rounded-full h-12 w-12 sm:h-16 sm:w-16 border-4 border-amber-200 border-t-amber-500"></div>
        <p class="mt-4 text-amber-600 font-medium text-sm sm:text-base">
          Chargement du dashboard...
        </p>
      </div>
    </div>
  </ng-template>
</app-admin-layout>